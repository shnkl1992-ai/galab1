<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>قلاب 1 - نسخة مبسطة</title>
<style>
body { margin:0; font-family:Tahoma; background:#0b1020; color:#fff; text-align:center; }
h1 { margin:10px; font-size:20px; }
button { margin:5px; padding:10px; font-size:16px; border-radius:8px; border:none; }
#arena { display:flex; flex-wrap:wrap; justify-content:center; margin-top:20px; }
.player { background:#1c2333; margin:5px; padding:10px; border-radius:10px; min-width:120px; }
.cards { margin:10px 0; }
.card { display:inline-block; padding:5px 8px; margin:2px; background:#333; border-radius:6px; }
#table { margin:20px; padding:10px; background:#162030; border-radius:10px; }
</style>
</head>
<body>

<h1>🎴 قلاب 1 — نسخة مبسطة (6 لاعبين)</h1>
<button onclick="deal()">توزيع جديد</button>
<button onclick="buy()">شراء من الأرض</button>
<button onclick="score()">حساب النقاط</button>

<div id="table">الأرض: <span id="ground"></span></div>
<div id="arena"></div>
<div id="results"></div>

<script>
let deck = [];
let players = [];
let ground = [];

function createDeck(){
  let suits = ["♠","♥","♦","♣"];
  let values = ["1","2","3","4","5","6","7","8","9","10","J","Q","K"];
  let cards = [];
  for(let s of suits){
    for(let v of values){
      cards.push(v+s);
    }
  }
  return cards;
}

function shuffle(array){
  for(let i=array.length-1;i>0;i--){
    let j=Math.floor(Math.random()*(i+1));
    [array[i],array[j]]=[array[j],array[i]];
  }
  return array;
}

function deal(){
  deck = shuffle(createDeck());
  players = [];
  for(let i=0;i<6;i++){
    let hand = deck.splice(0,5);
    if(i===0) hand.push(deck.pop()); // لاعب واحد يأخذ 6 كروت
    players.push({id:i+1,hand:hand,captures:[]});
  }
  // أوراق على الأرض (5 بطاقات)
  ground = deck.splice(0,5);
  render();
}

function buy(){
  let current = players[0]; // نخلي اللاعب الأول هو اللي يشتري مبدئياً
  if(current.hand.length===0){ alert("ما عنده كروت يشتري فيها"); return; }
  let card = current.hand.pop(); // ياخذ آخر كرت
  let matchIndex = ground.findIndex(c=>c.slice(0,-1)===card.slice(0,-1));
  if(matchIndex>-1){
    let taken = ground.splice(matchIndex,1)[0];
    current.captures.push(card,taken);
  }else{
    ground.push(card);
  }
  render();
}

function score(){
  let res="";
  for(let p of players){
    let points=0;
    for(let c of p.captures){
      let v=c.slice(0,-1);
      if(v==="10"||v==="J"||v==="Q"||v==="K"||v==="1") points++;
    }
    res+=`لاعب ${p.id}: ${points} نقطة<br>`;
  }
  document.getElementById("results").innerHTML=res;
}

function render(){
  let arena=document.getElementById("arena");
  arena.innerHTML="";
  for(let p of players){
    let div=document.createElement("div");
    div.className="player";
    div.innerHTML=`<b>لاعب ${p.id}</b><div class="cards">${p.hand.map(c=>`<span class="card">${c}</span>`).join("")}</div>
    <div>مجمع: ${p.captures.map(c=>`<span class="card">${c}</span>`).join("")}</div>`;
    arena.appendChild(div);
  }
  document.getElementById("ground").innerHTML=ground.map(c=>`<span class="card">${c}</span>`).join("");
}
</script>
</body>
</html>
